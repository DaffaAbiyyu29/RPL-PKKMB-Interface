<div class="row justify-content-center mb-5">
	<div class="col-lg">
		<div class="card">
			<h5 class="card-header white-text py-4 mb-4" style="background-color: #0059AB;">
				<strong>Detail Jam Plus / Jam Minus Mahasiswa <span id="kelompok"></span>&nbsp;<span class="float-end" id="namamhs"></span></strong>
				@*<strong>Nama : <span id="nama"></span></strong>*@
			</h5>
			<div class="card-body pt-1 scrollable-table">
				<table class="table table-hover table-sm" style="width:100%; border: 2px solid #dee2e6; border-radius: 10px; overflow: hidden;" id="tabellist">
					<thead>
						<tr>
							<th scope="col">No</th>
							<th scope="col">Tanggal</th>
							<th scope="col">Jenis Jam</th>
							<th scope="col">Jumlah</th>
							<th scope="col">Deskripsi</th>
							<th scope="col">Aksi</th>
						</tr>
					</thead>
				</table>
			</div>
		</div>
	</div>
</div>

<script>
	loadTable()

	function loadTable() {
		var hostname = 'https://localhost:7087/';
		var url = hostname + "GetDetailJamMahasiswa?dtj_nopendaftaran=@ViewBag.dtj_nopendaftaran";
		var method = "GET";
		var counter = 1;
		var detailData = [];

		$.ajax({
			url: url,
			method: method,
			contentType: "application/json",
			success: function (data) {
				var item = data.data;
				namaMahasiswa()

				$.each(item, function (key, val) {
					var aksi = '<a style="background-color: #3a4584 !important;" class="btn btn-primary" href="/JamPlusMinus/UbahJam/' + val.dtj_idjam + '/' + val.dtj_nopendaftaran + '"><i class="fa fa-pencil-alt" aria-hidden="true"></i></a>';
					detailData.push([counter, formatDateForDisplay(val.dtj_tanggal), val.dtj_jenisjam, val.dtj_jumlah, val.dtj_deskripsi, aksi])
					counter++;
				});

				$('#tabellist').DataTable({
					data: detailData,
					language: {
						search: "Cari :",
						zeroRecords: "Data Tidak Ditemukan",
						sLengthMenu: "Menampilkan _MENU_ data",
						info: "Menampilkan data ke - _START_ sampai _END_ dari _TOTAL_ data",
						infoEmpty: "Menampilkan 0 data",
						infoFiltered: "(Difilter dari _MAX_ total data)",
						paginate: {
							previous: "Sebelumnya",
							next: "Berikutnya"
						}
					}
				});
			},
			error: function (xhr, status, error) {
				console.log('Error fetching data:', error);
				console.log(xhr.responseJSON);
			}
		});
	}

	function formatDateForDisplay(dateString) {
		const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
		const formattedDate = new Date(dateString).toLocaleDateString('id-ID', options);
		return formattedDate;
	}

	function namaMahasiswa() {
		var mahasiswa = document.getElementById("namamhs");

		var hostname = "https://localhost:7087/";
		var url = hostname + "datamahasiswa?mhs_nopendaftaran=@ViewBag.dtj_nopendaftaran";
		var method = "GET";

		$.ajax({
			url: url,
			method: method,
			contentType: "application/json",
			success: function (data) {
				var item = data.data;
				mahasiswa.textContent = 'Nama : ' + item.mhs_namalengkap;
			},
		});
	}
</script>