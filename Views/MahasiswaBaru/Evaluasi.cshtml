<div class="row justify-content-center mb-5">
	<div class="col-lg">
		<div class="card">
			<h5 class="card-header white-text py-4 mb-4" style="background-color: #0059AB;">
				<strong>Evaluasi Mahasiswa Baru</strong>
			</h5>
			<div class="card-body pt-1 scrollable-table">
				<table class="table table-hover table-sm" style="width:100%; border: 2px solid #dee2e6; border-radius: 10px; overflow: hidden;" id="tabellist">
					<thead>
						<tr>
							<th scope="col">No</th>
							<th scope="col">Nama</th>
							<th scope="col">Kelompok</th>
							<th scope="col">Kritik</th>
							<th scope="col">Saran</th>
							<th id="thaksi" scope="col">Aksi</th>
						</tr>
					</thead>
					<tbody id="tbody">
						<tr>
							<td>1</td>
							<td>@ViewBag.UserName</td>
							<td id="kelompok"></td>
							<td id="kritik"></td>
							<td id="saran"></td>
							<td id="tdaksi"><a style="background-color: #3a4584 !important;" class="btn btn-primary" asp-controller="mahasiswabaru" asp-action="kirimevaluasi"><i class="fa fa-pencil-alt" aria-hidden="true" data-toggle="tooltip" data-placement="top" title="Kirim Evaluasi"></i></a></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>
</div>

<script>
	var idpkkmb = sessionStorage.getItem('id_pkkmb')

	var nopendaftaran = '@ViewBag.UserId';

	loadTable()

	function loadTable() {
		var hostname = 'https://localhost:7087/';
		var url = hostname + "datamahasiswa?mhs_nopendaftaran=" + nopendaftaran;
		var method = "GET";
		var counter = 1;

		$.ajax({
			url: url,
			method: method,
			contentType: "application/json",
			success: function (data) {
				var item = data.data;
				console.log(item)
				if (item.mhs_aspek1 != 0 || item.mhs_aspek2 != 0 || item.mhs_aspek3 != 0 || item.mhs_aspek4 != 0 || item.mhs_aspek5 != 0 || item.mhs_aspek6 != 0 || item.mhs_kritik != '' || item.mhs_saran != '') {
					$('#thaksi').hide()
					$('#tdaksi').hide()
				}

				getNamaKelompok(item.mhs_idkelompok)
				var kritikElement = document.getElementById("kritik");
				var saranElement = document.getElementById("saran");

				kritikElement.textContent = item.mhs_kritik;
				saranElement.textContent = item.mhs_saran;
			},
			error: function (error) {
				console.error("Error loading data:", error);
			}
		});
	}

	function getNamaKelompok(id) {
		var hostname = "https://localhost:7087/";
		var url = hostname + "GetKelompok?kmk_idkelompok=" + id;
		var method = "GET";

		$.ajax({
			url: url,
			method: method,
			contentType: "application/json",
			success: function (data) {
				var item = data.data;
				var kelompokElement = document.getElementById("kelompok");
				kelompokElement.textContent = item.kmk_namakelompok;
			},
			error: function (error) {
				console.error("Error fetching data: ", error);
			},
		});
	}
</script>
